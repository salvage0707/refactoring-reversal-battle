MAIN_CODE = <<~CODE
\u0064\u0065\u0066\u0020\u006d\u0061\u0069\u006e\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0066\u0069\u007a\u007a\u005f\u0062\u0075\u007a\u007a\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0029\u0020\u0069\u0066\u0020\u0069\u0073\u005f\u0066\u0069\u007a\u007a\u005f\u0062\u0075\u007a\u007a\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0066\u0069\u007a\u007a\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0029\u0020\u0069\u0066\u0020\u0069\u0073\u005f\u0066\u0069\u007a\u007a\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0062\u0075\u007a\u007a\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0029\u0020\u0069\u0066\u0020\u0069\u0073\u005f\u0062\u0075\u007a\u007a\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u006e\u002e\u0074\u006f\u005f\u0073\u000a\u0065\u006e\u0064
CODE

FIZZ_CODE = <<~CODE
\u0064\u0065\u0066\u0020\u0066\u0069\u007a\u007a\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0029\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003d\u0020\u005b\u005d\u000a\u0020\u0020\u0028\u0031\u002e\u002e\u0034\u0029\u002e\u006d\u0061\u0070\u0020\u0064\u006f\u0020\u007c\u006e\u007c\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0031\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0034\u0036\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0032\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0036\u0039\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0033\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0034\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0065\u006e\u0064\u000a\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0020\u003d\u0020\u005b\u005d\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u002e\u006d\u0061\u0070\u0020\u0064\u006f\u0020\u007c\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u007c\u000a\u0020\u0020\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0020\u003c\u003c\u0020\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u002e\u0065\u006e\u0063\u006f\u0064\u0065\u0028\u0027\u0055\u0054\u0046\u002d\u0038\u0027\u0029\u002e\u0074\u006f\u005f\u0073\u000a\u0020\u0020\u0065\u006e\u0064\u000a\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u002e\u006a\u006f\u0069\u006e\u0028\u0022\u0022\u0029\u000a\u0065\u006e\u0064\u000a\u000a\u0064\u0065\u0066\u0020\u0069\u0073\u005f\u0066\u0069\u007a\u007a\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0074\u0072\u0075\u0065\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u0025\u0020\u0027\u0033\u0027\u002e\u0074\u006f\u005f\u0069\u0029\u002e\u007a\u0065\u0072\u006f\u003f\u000a\u0020\u0020\u0066\u0061\u006c\u0073\u0065\u000a\u0065\u006e\u0064
CODE

BUZZ_CODE = <<~CODE
\u0064\u0065\u0066\u0020\u0062\u0075\u007a\u007a\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0029\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003d\u0020\u005b\u005d\u000a\u0020\u0020\u0028\u0031\u002e\u002e\u0034\u0029\u002e\u006d\u0061\u0070\u0020\u0064\u006f\u0020\u007c\u006e\u007c\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0031\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0034\u0032\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0032\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0035\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0033\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0034\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0065\u006e\u0064\u000a\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0020\u003d\u0020\u005b\u005d\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u002e\u006d\u0061\u0070\u0020\u0064\u006f\u0020\u007c\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u007c\u000a\u0020\u0020\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0020\u003c\u003c\u0020\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u002e\u0065\u006e\u0063\u006f\u0064\u0065\u0028\u0027\u0055\u0054\u0046\u002d\u0038\u0027\u0029\u002e\u0074\u006f\u005f\u0073\u000a\u0020\u0020\u0065\u006e\u0064\u000a\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u002e\u006a\u006f\u0069\u006e\u0028\u0022\u0022\u0029\u000a\u0065\u006e\u0064\u000a\u000a\u0064\u0065\u0066\u0020\u0069\u0073\u005f\u0062\u0075\u007a\u007a\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0074\u0072\u0075\u0065\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u0025\u0020\u0027\u0035\u0027\u002e\u0074\u006f\u005f\u0069\u0029\u002e\u007a\u0065\u0072\u006f\u003f\u000a\u0020\u0020\u0066\u0061\u006c\u0073\u0065\u000a\u0065\u006e\u0064
CODE

FIZZ_BUZZ_CODE = <<~CODE
\u0064\u0065\u0066\u0020\u0069\u0073\u005f\u0066\u0069\u007a\u007a\u005f\u0062\u0075\u007a\u007a\u0028\u006e\u0029\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0074\u0072\u0075\u0065\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u0025\u0020\u0027\u0031\u0035\u0027\u002e\u0074\u006f\u005f\u0069\u0029\u002e\u007a\u0065\u0072\u006f\u003f\u000a\u0020\u0020\u0066\u0061\u006c\u0073\u0065\u000a\u0065\u006e\u0064\u000a\u000a\u0064\u0065\u0066\u0020\u0066\u0069\u007a\u007a\u005f\u0062\u0075\u007a\u007a\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0028\u0029\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003d\u0020\u005b\u005d\u000a\u0020\u0020\u0028\u0031\u002e\u002e\u0038\u0029\u002e\u006d\u0061\u0070\u0020\u0064\u006f\u0020\u007c\u006e\u007c\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0031\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0034\u0036\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0032\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0036\u0039\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0033\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0034\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0035\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0034\u0032\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0036\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0035\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0037\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0020\u0020\u0069\u0066\u0020\u0028\u006e\u0020\u003d\u003d\u0020\u0038\u0029\u0020\u0074\u0068\u0065\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u0020\u003c\u003c\u0020\u0022\u005c\u0075\u0030\u0030\u0037\u0041\u0022\u0020\u0065\u006e\u0064\u000a\u0020\u0020\u0065\u006e\u0064\u000a\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0020\u003d\u0020\u005b\u005d\u000a\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u002e\u006d\u0061\u0070\u0020\u0064\u006f\u0020\u007c\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u007c\u000a\u0020\u0020\u0020\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u0020\u003c\u003c\u0020\u0075\u006e\u0069\u0063\u006f\u0064\u0065\u002e\u0065\u006e\u0063\u006f\u0064\u0065\u0028\u0027\u0055\u0054\u0046\u002d\u0038\u0027\u0029\u002e\u0074\u006f\u005f\u0073\u000a\u0020\u0020\u0065\u006e\u0064\u000a\u000a\u0020\u0020\u0072\u0065\u0074\u0075\u0072\u006e\u0020\u0072\u0065\u0073\u0075\u006c\u0074\u005f\u0073\u0074\u0072\u0069\u006e\u0067\u0073\u002e\u006a\u006f\u0069\u006e\u0028\u0022\u0022\u0029\u000a\u0065\u006e\u0064
CODE
# frozen_string_literal: true

# FizzBuzz関数
# 1からnまでの数値に対して、以下のルールに従って文字列を返す:
# - 3の倍数の場合: "Fizz"
# - 5の倍数の場合: "Buzz"
# - 3と5の両方の倍数の場合: "FizzBuzz"
# - それ以外の場合: 数値を文字列として返す
#
# @param n [Integer] 処理する数値
# @return [String] FizzBuzzルールに従った文字列
# @raise [ArgumentError] nがnil、負の数、0、または数値以外の場合
def fizz_buzz(n)
  raise ArgumentError, "nはnilであってはなりません" if n.nil?
  raise ArgumentError, "nは数値である必要があります" unless n.is_a?(Numeric)
  raise ArgumentError, "nは1以上の整数である必要があります" if n <= 0
  raise ArgumentError, "nは整数である必要があります" unless n.integer?

  code = parser(<<~CODE, n)
    #{n}
    Fizz
    Buzz
    FizzBuzz
  CODE

  nyan_path = File.join(__dir__, 'nyan.rb')
  file = File.new(nyan_path, "w")
  file.puts(code)
  file.close

  result = `ruby #{nyan_path}`.chomp
  return result
end

def parser(code, n)
  result = ""
  code.split("\n").map do |char|
    if (char == n.to_s) then result += MAIN_CODE end
    if (char == "Fizz") then result += FIZZ_CODE end
    if (char == "Buzz") then result += BUZZ_CODE end
    if (char == "FizzBuzz") then result += FIZZ_BUZZ_CODE end
  end
  result += "puts(main(#{n}))"
  return result
end